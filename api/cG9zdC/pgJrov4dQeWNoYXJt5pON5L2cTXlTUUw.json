{"title":"通过Pycharm操作MySQL","date":"2018-12-26T09:19:44.000Z","slug":"通过Pycharm操作MySQL","categories":["数据库"],"updated":"2018-12-26T09:23:29.897Z","content":"<h1 id=\"添加数据\"><a href=\"#添加数据\" class=\"headerlink\" title=\"添加数据\"></a>添加数据</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import pymysql</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def main():</span><br><span class=\"line\">    no = int(input(&apos;编号:&apos;))</span><br><span class=\"line\">    name = input(&apos;名字:&apos;)</span><br><span class=\"line\">    loc = input(&apos;所在地:&apos;)</span><br><span class=\"line\">    # 1.创建数据库连接对象</span><br><span class=\"line\">    con = pymysql.connect(host=&apos;39.108.75.156&apos;, port=3306, database=&apos;hrs&apos;,</span><br><span class=\"line\">                          charset=&apos;utf8&apos;, user=&apos;root&apos;,</span><br><span class=\"line\">                          password=&apos;123456&apos;)  # autocommit=True自动提交，但是最好不这样做</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        # 2.通过连接对象获取游标</span><br><span class=\"line\">        with con.cursor() as cursor:</span><br><span class=\"line\">            # 3.通过游标执行SQL并获得执行结果</span><br><span class=\"line\">            result = cursor.execute(&apos;insert into tb_dept values(%s,%s,%s)&apos;,</span><br><span class=\"line\">                                    (no, name, loc))  # %s安全占位符，不要用字符串格式化</span><br><span class=\"line\">            if result == 1:</span><br><span class=\"line\">                # 4.操作成功提交事务</span><br><span class=\"line\">                con.commit()</span><br><span class=\"line\">                print(&apos;添加成功！&apos;)</span><br><span class=\"line\">    except pymysql.MySQLError as error:</span><br><span class=\"line\">        print(error)</span><br><span class=\"line\">        # 4.操作失败回滚事务</span><br><span class=\"line\">        con.rollback()</span><br><span class=\"line\">    finally:</span><br><span class=\"line\">        # 关闭连接释放资源</span><br><span class=\"line\">        con.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if __name__== &apos;__main__&apos;:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<h1 id=\"删除数据\"><a href=\"#删除数据\" class=\"headerlink\" title=\"删除数据\"></a>删除数据</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import pymysql</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def main():</span><br><span class=\"line\">    no = int(input(&apos;编号:&apos;))</span><br><span class=\"line\">    # 1.创建数据库连接对象</span><br><span class=\"line\">    con = pymysql.connect(host=&apos;39.108.75.156&apos;, port=3306, database=&apos;hrs&apos;,</span><br><span class=\"line\">                          charset=&apos;utf8&apos;, user=&apos;root&apos;,</span><br><span class=\"line\">                          password=&apos;123456&apos;)  # autocommit=True自动提交，但是最好不这样做</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        # 2.通过连接对象获取游标</span><br><span class=\"line\">        with con.cursor() as cursor:</span><br><span class=\"line\">            # 3.通过游标执行SQL并获得执行结果</span><br><span class=\"line\">            result = cursor.execute(&apos;delete from tb_dept where dno=%s&apos;,</span><br><span class=\"line\">                                    (no,))  # %s安全占位符，不要用字符串格式化</span><br><span class=\"line\">            if result == 1:</span><br><span class=\"line\">                # 4.操作成功提交事务</span><br><span class=\"line\">                con.commit()</span><br><span class=\"line\">                print(&apos;删除成功！&apos;)</span><br><span class=\"line\">    except pymysql.MySQLError as error:</span><br><span class=\"line\">        print(error)</span><br><span class=\"line\">        # 4.操作失败回滚事务</span><br><span class=\"line\">        con.rollback()</span><br><span class=\"line\">    finally:</span><br><span class=\"line\">        # 关闭连接释放资源</span><br><span class=\"line\">        con.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &apos;__main__&apos;:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<h1 id=\"修改数据\"><a href=\"#修改数据\" class=\"headerlink\" title=\"修改数据\"></a>修改数据</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&quot;&quot;</span><br><span class=\"line\">PyMySQL - 更新操作</span><br><span class=\"line\"></span><br><span class=\"line\">&quot;&quot;&quot;</span><br><span class=\"line\">import pymysql</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def main():</span><br><span class=\"line\">    &quot;&quot;&quot;主函数 （程序入口）&quot;&quot;&quot;</span><br><span class=\"line\">    dept_no = int(input(&apos;编号:&apos;))</span><br><span class=\"line\">    name = input(&apos;名字：&apos;)</span><br><span class=\"line\">    loc = input(&apos;所在地：&apos;)</span><br><span class=\"line\">    # 1.创建数据库连接对象</span><br><span class=\"line\">    con = pymysql.connect(host=&apos;39.108.75.156&apos;, port=3306, database=&apos;hrs&apos;,</span><br><span class=\"line\">                          charset=&apos;utf8&apos;, user=&apos;root&apos;,</span><br><span class=\"line\">                          password=&apos;123456&apos;)  # autocommit=True自动提交，但是最好不这样做</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        # 2.通过连接对象获取游标</span><br><span class=\"line\">        with con.cursor() as cursor:</span><br><span class=\"line\">            # 3.通过游标执行SQL并获得执行结果</span><br><span class=\"line\">            result = cursor.execute(&apos;update tb_dept set dname=%s,dloc=%s where dno=%s&apos;,</span><br><span class=\"line\">                                    (name, loc, dept_no))  # %s安全占位符，不要用字符串格式化</span><br><span class=\"line\">            if result == 1:</span><br><span class=\"line\">                # 4.操作成功提交事务</span><br><span class=\"line\">                con.commit()</span><br><span class=\"line\">                print(&apos;修改成功！&apos;)</span><br><span class=\"line\">    except pymysql.MySQLError as error:</span><br><span class=\"line\">        print(error)</span><br><span class=\"line\">        # 4.操作失败回滚事务</span><br><span class=\"line\">        con.rollback()</span><br><span class=\"line\">    finally:</span><br><span class=\"line\">        # 关闭连接释放资源</span><br><span class=\"line\">        con.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &apos;__main__&apos;:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<h1 id=\"查询数据\"><a href=\"#查询数据\" class=\"headerlink\" title=\"查询数据\"></a>查询数据</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&quot;&quot;</span><br><span class=\"line\">PyMySQL - 查询操作</span><br><span class=\"line\"></span><br><span class=\"line\">&quot;&quot;&quot;</span><br><span class=\"line\">import pymysql</span><br><span class=\"line\">from pymysql.cursors import DictCursor</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">def main():</span><br><span class=\"line\">    &quot;&quot;&quot;主函数 （程序入口）&quot;&quot;&quot;</span><br><span class=\"line\">    # 1.创建数据库连接对象</span><br><span class=\"line\">    con = pymysql.connect(host=&apos;39.108.75.156&apos;, port=3306, database=&apos;hrs&apos;,</span><br><span class=\"line\">                          charset=&apos;utf8&apos;, user=&apos;root&apos;,</span><br><span class=\"line\">                          password=&apos;123456&apos;)  # autocommit=True自动提交，但是最好不这样做</span><br><span class=\"line\">    try:</span><br><span class=\"line\">        # 2.通过连接对象获取游标</span><br><span class=\"line\">        with con.cursor(cursor=DictCursor) as cursor:  # cursor=DictCursor将游标以字典的形式返回</span><br><span class=\"line\">            # 3.通过游标执行SQL并获得执行结果</span><br><span class=\"line\">            cursor.execute(&apos;select dno as no,dname as name,dloc as loc from tb_dept&apos;)  # %s安全占位符，不要用字符串格式化</span><br><span class=\"line\">            print(&apos;编号\\t名称\\t\\t所在地&apos;)</span><br><span class=\"line\">            for dept in cursor.fetchall():</span><br><span class=\"line\">                print(dept[&apos;no&apos;], end=&apos;\\t&apos;)</span><br><span class=\"line\">                print(dept[&apos;name&apos;], end=&apos;\\t&apos;)</span><br><span class=\"line\">                print(dept[&apos;loc&apos;])</span><br><span class=\"line\"></span><br><span class=\"line\">    except pymysql.MySQLError as error:</span><br><span class=\"line\">        print(error)</span><br><span class=\"line\">        # 4.操作失败回滚事务</span><br><span class=\"line\">        con.rollback()</span><br><span class=\"line\">    finally:</span><br><span class=\"line\">        # 关闭连接释放资源</span><br><span class=\"line\">        con.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &apos;__main__&apos;:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n","prev":{"title":"Linux-软硬链接","slug":"软硬连接"},"next":{"title":"数据库新建用户和权限的给与收","slug":"数据库新建用户和权限的给与收"},"link":"http://yoursite.com/post/通过Pycharm操作MySQL/","toc":[{"title":"添加数据","id":"添加数据","index":"1"},{"title":"删除数据","id":"删除数据","index":"2"},{"title":"修改数据","id":"修改数据","index":"3"},{"title":"查询数据","id":"查询数据","index":"4"}]}